# ECU Quantity Units - 테스트 요약

## 📋 테스트 구조

### 1. **QuantityTest.kt** - 기본 단위 테스트
- ✅ 기본 수량 생성 및 변환
- ✅ 문자열 파싱
- ✅ 단위 간 변환
- ✅ 커스텀 포장 단위
- ✅ 산술 연산
- ✅ 정밀도 및 라운딩
- ✅ 잘못된 연산 처리

### 2. **QuantityBusinessTest.kt** - 비즈니스 시나리오 테스트
실제 비즈니스 상황을 시뮬레이션하는 테스트들:

#### 🛒 온라인 식료품점 시나리오
- 계란 2판 주문 → 60개 변환
- 재고 부족 시 대안 제시 (3판까지 가능)
- kg 단위 과일을 개수로 변환
- 혼합 장바구니 총 아이템 수 계산

#### 🏭 B2B 도매 거래 시나리오
- 최소 주문 수량(MOQ) 자동 조정
- 대량 주문 시 최적 포장 단위 제안
- 용지 대량 주문의 팔레트 변환
- 부분 팔레트를 박스로 표현

#### 📊 재고 관리 시나리오
- 월간 재고 회전율 계산
- 안전 재고 수준 확인
- 다양한 단위로 입출고 관리

#### 🌍 국제 무역 시나리오
- 컨테이너 적재 효율성 계산
- 다양한 포장 형태 혼합 주문
- 수출 문서용 정확한 수량 계산

#### 💰 가격 계산 통합
- 단위별 차별 가격 적용
- 대량 구매 할인 반영

### 3. **QuantityEdgeCaseTest.kt** - 엣지 케이스 테스트

#### ❌ 잘못된 입력 처리
- 음수 수량 거부
- 0 또는 음수 포장 크기 거부
- 알 수 없는 단위 오류
- 잘못된 형식 문자열 처리

#### 🔢 극단적인 값 처리
- 10억 개 같은 매우 큰 수량
- 0.001개 같은 매우 작은 수량
- 0 수량 특수 처리
- 0으로 나누기 방지

#### 📐 라운딩 엣지 케이스
- 정확히 0.5일 때 각 모드별 동작
- MOQ < 포장 단위일 때 처리
- 분수 허용/비허용 모드 차이

#### ⚙️ 설정 충돌 처리
- 동일 제품 ID 중복 등록 시 덮어쓰기
- 존재하지 않는 제품 변환 오류
- 순환 참조 환산 정상 작동

#### 📦 재고 특수 상황
- 정확히 재고량과 같은 주문
- 재고 0일 때 처리
- 최소 포장 요구사항 미달

#### 🔬 부동소수점 정밀도
- 0.1 + 0.2 = 0.3 문제 처리
- 무한 소수 처리 (10/3)
- 매우 작은 차이 비교 (1e-10)

#### ⚡ 성능 테스트
- 10,000건 배치 변환 1초 이내
- 깊은 계층 구조 최적화

### 4. **QuantityIntegrationTest.kt** - 통합 테스트

#### ☕ 전체 주문 프로세스
- 커피 제품 등록 (1박스=12봉)
- 초기 재고 50박스
- 3개 주문 처리 (개인/소매/대형)
- 재고 차감 및 재주문점 확인

#### 🏪 B2B 도매 프로세스
- 플라스틱 병 대량 거래
- MOQ 5카톤 적용
- 수량별 차등 가격
- 총 매출 및 판매량 집계

#### 🌏 다국가 물류 센터
- 서울/도쿄/싱가포르 재고
- 안전재고 미달 창고 식별
- 창고 간 재고 이동
- 재고 수준 시각화 (🔴🟡🟢)

## 🎯 테스트 커버리지

### 핵심 기능
- ✅ 기본 수량 변환 (pieces, dozens, gross, ream)
- ✅ 제품별 커스텀 환산 비율
- ✅ 포장 계층 최적화
- ✅ 라운딩 프로파일 (MOQ, 포장 단위)
- ✅ 재고 가용성 확인
- ✅ 대안 제시 기능

### 실무 시나리오
- ✅ 이커머스 주문 처리
- ✅ B2B 최소 주문 수량
- ✅ 재고 이동 및 관리
- ✅ 수출입 컨테이너 적재
- ✅ 가격 책정 통합

### 예외 처리
- ✅ 잘못된 입력 검증
- ✅ 극단값 처리
- ✅ 부동소수점 정밀도
- ✅ 성능 최적화

## 🚀 테스트 실행 방법

```bash
# 전체 테스트 실행
./gradlew test

# 특정 테스트 클래스만 실행
./gradlew test --tests "io.ecu.QuantityBusinessTest"

# 특정 테스트 메서드만 실행
./gradlew test --tests "io.ecu.QuantityBusinessTest.customer orders 2 egg trays"

# 테스트 리포트 확인
open build/reports/tests/test/index.html
```

## 📊 예상 테스트 결과

- **총 테스트 수**: 약 50개
- **예상 성공률**: 100%
- **실행 시간**: < 5초
- **커버리지**: 주요 비즈니스 로직 90% 이상

## 💡 테스트 작성 원칙

1. **실제 비즈니스 상황 반영**: 가상의 시나리오가 아닌 실제 발생 가능한 상황
2. **명확한 검증**: 각 테스트는 하나의 명확한 목적
3. **읽기 쉬운 이름**: `@DisplayName`으로 한글 설명 제공
4. **독립적 실행**: 각 테스트는 독립적으로 실행 가능
5. **엣지 케이스 포함**: 정상 케이스뿐만 아니라 예외 상황도 테스트

## 🔍 주요 검증 포인트

### 정확성
- 환산 계산의 정확성
- 라운딩 규칙 적용
- 제품별 설정 분리

### 안정성
- 잘못된 입력 처리
- 극단값 처리
- 동시성 문제 없음

### 사용성
- 직관적인 API
- 명확한 오류 메시지
- 유용한 대안 제시

### 성능
- 대량 변환 처리
- 메모리 효율성
- 응답 시간
